<html>
    <!-- Import Three.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.157.0/three.js" 
    integrity="sha512-8DQ21zI0ic9mMNCPYj225sCbU8LGPu/T7u97ix4/P+WqAJIIuuG6w/fPoOFC6LfZGqUE85etxR4W0ia2IyRFiw==" 
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <head>
    <meta charset="UTF-8">
    <style type="text/css">
    </style>
    <title>3D</title>
    </head>

  <body>
    <h1>Shane</h1>
    <script type="text/javascript">

      // Tetrahedron class
      class Tetrahedron {
        constructor() {
          const geometry = new THREE.TetrahedronGeometry(3,0); // (Radius, detail)
          //const material = new THREE.MeshBasicMaterial({ color: 0xffff00, wireframe: true });
          const material = new THREE.MeshLambertMaterial({ color: 0xffffff});
          this.tetrahedron = new THREE.Mesh(geometry, material);
          this.tetrahedron.castShadow = true;

          const wireframeMaterial = new THREE.MeshLambertMaterial({color: 0xfff00});
          const wireframe = new THREE.LineSegments(new THREE.EdgesGeometry(geometry), wireframeMaterial);
        
          this.tetrahedron.add(wireframe);
          scene.add(this.tetrahedron);

          // Initial position & velocity
          this.tetrahedron.position.x = 0;
          this.tetrahedron.position.y = 0;
          this.xVelocity = 0.08;
          this.yVelocity = 0.08;
        }


        move(){
          //Move
          this.tetrahedron.position.x += this.xVelocity
          this.tetrahedron.position.y += this.yVelocity;

          //Accelerate vertically
          this.yVelocity -= 0.005;

          //console.log("X: " + this.tetrahedron.position.x);
          console.log("Y: " + this.tetrahedron.position.y);

          let gravity = 0.90;

          //bounce back
          // Bounce off cubes left and right
          if (this.tetrahedron.position.x > 4.5 || this.tetrahedron.position.x < -4.5) {
            this.xVelocity *= -gravity;
          }

          // Bounce off cubes top and bottom
          if(this.tetrahedron.position.y > 4.5 || this.tetrahedron.position.y < -2) {
            this.yVelocity *= -gravity;
          }

          //Rotate
          this.tetrahedron.rotation.x += 0.01;
          this.tetrahedron.rotation.y += 0.01;
        }

        colorChange(){
          colorProg += 1/changeDur;

          if(colorProg > 1) {
            colorProg = 1;
          }

          tetrahedron.tetrahedron.material.color.lerpColors(startColor, endColor, colorProg);

          //console.log(colorProg);
          if(colorProg >= 1) {
            let temp = startColor;
            startColor = endColor;
            endColor = temp;
            colorProg = 0;
          }

          tetrahedron.tetrahedron.material.needsUpdate = true;
        }

      }

        // Implement scene, camera and renderer.
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera( 80, window.innerWidth / window.innerHeight, 0.1, 1000 );
        camera.position.z = 15;

        const renderer = new THREE.WebGLRenderer();
        renderer.setSize( window.innerWidth, window.innerHeight );
        document.body.appendChild( renderer.domElement );

        const tetrahedron = new Tetrahedron();

        //cube creation
        const cubeGeometry = new THREE.BoxGeometry(10, 10, 10);
        const cubeMaterial = new THREE.MeshLambertMaterial({ color: 000000, transparent: true, opacity: 0.6 });
        const cube = new THREE.Mesh(cubeGeometry, cubeMaterial);
        scene.add(cube);

        //enable shadow
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;

        document.body.appendChild(renderer.domElement);

        // Create spotlight
        var spotLight = new THREE.SpotLight(0xffffff);
        spotLight.position.set(0, 10, 10);
        spotLight.castShadow = true;
        spotLight.intensity = 1000;
        scene.add(spotLight);

        /*
        // spotlight Helper - Debug tool
        const spotLightHelper = new THREE.SpotLightHelper( spotLight );
        scene.add( spotLightHelper );
        */

        // Color Change Variables
        let colorProg = 0;
        let changeDur = 200;
        let startColor = new THREE.Color(0xfff00);
        let endColor = new THREE.Color(0xff00ff);

        // Plane creation
        const geometry = new THREE.PlaneGeometry( 30, 30 );
        const material = new THREE.MeshLambertMaterial( {color: 0x888888} );
        const plane = new THREE.Mesh( geometry, material );
        plane.rotation.x = -Math.PI/2;
        plane.position.y = -5;
        plane.receiveShadow = true;
        scene.add( plane );

        function repeatMe() {
            //Setup renderer
            renderer.render(scene, camera);

            tetrahedron.move();
            tetrahedron.colorChange();

            requestAnimationFrame(repeatMe);
        }
        repeatMe();

    </script>
  </body>
</html>